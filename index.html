<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS"
        crossorigin="anonymous">

    <link rel="stylesheet" href="assets/style.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css">
    <link rel="stylesheet" href="assets/style.css">

    <link href="https://fonts.googleapis.com/css?family=Coiny" rel="stylesheet">
    <script src="https://cdn.firebase.com/libs/firebaseui/3.5.1/firebaseui.js"></script>
    <link type="text/css" rel="stylesheet" href="https://cdn.firebase.com/libs/firebaseui/3.5.1/firebaseui.css" />

    <link href="https://fonts.googleapis.com/css?family=Vibur" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.min.css">
    </head>
    <title>Heartbreaker Catfish</title>
</head>

<body>
    <div class="backgroundContainer">
        <div class="jumbotron title">
            <h1 class="logo display-4"><b>A<span>n</span>g<span>le</span>r</b></h1>
        </div>
        <div id="heartBreakContainer">
            <div class="newImg"></div>
            <div class="displayImg"></div>
            </row>
            <br>
            <div id="percent-match"></div>
            <div id="error"></div>


            <form method="post" enctype="multipart/form-data" id="imageUploadForm">
                <input type="file" id="imageUpload" name="imageUpload">
                <input type="submit">

                <div id="newDiv"></div>
                <div class="row">
                    <!-- <div class="card" style="width: 18rem;">
                        <img src="..." class="card-img-top" alt="...">
                        <div class="card" id="loginCard" style="width: 18rem;">
                            <div class="card-body ">
                                <h5 class="card-title">Card title</h5>
                                <div id="firebaseui-auth-container"></div>
                            </div>
                        </div> -->

                        <div class="col-2"></div>
                    </div>

                    <!-- <div class="card" style="width: 18rem;">
                        <div class="card-body">
                            <h5 class="card-title">Card title</h5>
                            <p class="card-text"> Some quick example text to </p>
                        </div>
                    </div> -->
                </div>

        </div>


        <!-- <div class="card" id="loginCard" style="width: 18rem;">
            <div class="card-body">
                <h5 class="card-title">Card title</h5>
                <div id="firebaseui-auth-container"></div>
            </div>
            <div id="componentContainer">

            </div> -->

            <footer class="footer mt-auto py-3">
                <div class=container">
                    <span class="text-muted">Bootcamp Project 1</span>
                </div>
            </footer>
</body>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script>

    // put your keys in the header
    var headers = {
        "Content-type": "application/json",
        "app_id": "eb3e0c47",
        "app_key": "f621d6e0fa24c809a3f79b652dbb00d9"
    };
    var payload1 = {
        "image": "https://files.slack.com/files-pri/TE8LHCVLJ-FFEBWJZV2/alex_trebek.jpg",
        "gallery_name": "project1",
        "subject_id": "alex"
      };
      var payload2 = {
        "image": "https://files.slack.com/files-pri/TE8LHCVLJ-FFEGTPETU/angelina_jolie.jpg",
        "gallery_name": "project1",
        "subject_id": "angelina"
      };
      var payload3 = {
        "image": "https://files.slack.com/files-pri/TE8LHCVLJ-FFDQJMMCG/brad_pitt.jpg",
        "gallery_name": "project1",
        "subject_id": "brad"
      };
      var payload4 = {
        "image": "https://files.slack.com/files-pri/TE8LHCVLJ-FFDUFMR8R/bruce_jenner.jpg",
        "gallery_name": "project1",
        "subject_id": "bruce"
      };
      var payload5 = {
        "image": "https://files.slack.com/files-pri/TE8LHCVLJ-FFEBWDY3W/caitlyn_jenner.jpg",
        "gallery_name": "project1",
        "subject_id": "caitlyn"
      };
      var payload6 = {
        "image": "https://files.slack.com/files-pri/TE8LHCVLJ-FFFJDHEFR/daisy_ridley.jpg",
        "gallery_name": "project1",
        "subject_id": "daisy"
      };
      var payload7 = {
        "image": "https://files.slack.com/files-pri/TE8LHCVLJ-FFFUPBWTY/eva_mendes.jpg",
        "gallery_name": "project1",
        "subject_id": "eva"
      };
      var payload8 = {
        "image": "https://files.slack.com/files-pri/TE8LHCVLJ-FFFUP8W4E/george_clooney.jpg",
        "gallery_name": "project1",
        "subject_id": "george"
      };
      var payload9 = {
        "image": "https://files.slack.com/files-pri/TE8LHCVLJ-FFFJDKMFH/jackie_chan.jpg",
        "gallery_name": "project1",
        "subject_id": "jackie"
      };
      var payload10 = {
        "image": "https://files.slack.com/files-pri/TE8LHCVLJ-FFFUP2LAJ/jennifer_garner.jpg",
        "gallery_name": "project1",
        "subject_id": "jenniferg"
      };
      var payload11 = {
        "image": "https://files.slack.com/files-pri/TE8LHCVLJ-FFFJE9VLP/jennifer_lawrence.jpg",
        "gallery_name": "project1",
        "subject_id": "jeneniferla"
      };
      var payload12 = {
        "image": "https://files.slack.com/files-pri/TE8LHCVLJ-FFEBWV944/jennifer_lopez.jpg",
        "gallery_name": "project1",
        "subject_id": "jenniferlo"
      };
      var payload13 = {
        "image": "https://files.slack.com/files-pri/TE8LHCVLJ-FFFUPKR9U/jet_li.jpg",
        "gallery_name": "project1",
        "subject_id": "jet"
      };
      var payload14 = {
        "image": "https://files.slack.com/files-pri/TE8LHCVLJ-FFENSBKNZ/kim_kardashian.jpg",
        "gallery_name": "project1",
        "subject_id": "kim"
      };
      var payload15 = {
        "image": "https://files.slack.com/files-pri/TE8LHCVLJ-FFFUP5D9C/leonardo_dicaprio.jpg",
        "gallery_name": "project1",
        "subject_id": "leonardo"
      };
      var payload16 = {
        "image": "https://files.slack.com/files-pri/TE8LHCVLJ-FFDUG9XMX/rosario_dawson.jpg",
        "gallery_name": "project1",
        "subject_id": "rosario"
      };
      var payload17 = {
        "image": "https://files.slack.com/files-pri/TE8LHCVLJ-FFEBXEWN8/shia_labeouf.jpg",
        "gallery_name": "project1",
        "subject_id": "shia"
      };
      var payload18 = {
        "image": "https://files.slack.com/files-pri/TE8LHCVLJ-FFDUG8E9X/tom_cruise.jpg",
        "gallery_name": "project1",
        "subject_id": "tom"
      };
      var payload19 = {
        "image": "https://files.slack.com/files-pri/TE8LHCVLJ-FFDQK7Y48/will_smith.jpg",
        "gallery_name": "project1",
        "subject_id": "will"
      };
      var payload20 = {
        "image": "https://files.slack.com/files-pri/TE8LHCVLJ-FFEGU96US/zoe_saldana.jpg",
        "gallery_name": "project1",
        "subject_id": "zoe"
      };
      var arr = [payload1, payload2, payload3, payload4, payload5, payload6, payload7, payload8, payload9, payload10, payload11, payload12, payload13, payload14, payload15, payload16, payload17,
        payload18, payload19, payload20
      ];


    $(window).load(function (a) {

// url
var url = "http://api.kairos.com/enroll";

for (var i = 0; i < arr.length; i++) {
//console.log(arr[i]);
$("<img />")
.attr('src', arr[i].image)
.attr('id', arr[i].subject_id)
.width("113px").height("113px")
.appendTo($("#newDiv"));

//how would i consolelog this


$.ajax(url, {
headers: headers,
type: "POST",
data: JSON.stringify(arr[i]),
dataType: "text"
})

};

});

$("#imageUploadForm").submit(function (e) {
$(".newImg").empty();
e.preventDefault();
var input = $("#imageUpload")[0];
var file = input.files[0];
var reader = new FileReader();
reader.onload = function(r) {
$("#submitId").attr("src", r.target.result);
};
reader.readAsDataURL(file);
reader.onloadend = function () {
var imageData = String(reader.result);
//console.log(imageData);
var image = new Image(),
containerWidth = null,
containerHeight = null;
image.onload = function () {
containerWidth = image.width;
containerHeight = image.height;
}
image.src = imageData;

$(".newImg").append(image);

var payload = {
"image": imageData,
"gallery_name": "project1",
"threshold": 0.000
};
//console.log(payload);
var url = "http://api.kairos.com/recognize";
// make request
$.ajax(url, {
headers: headers,
type: "POST",
data: JSON.stringify(payload),
dataType: "text"
}).done(function (response) {
console.log(JSON.parse(response));
var obj = JSON.parse(response);
//onsole.log(obj);
if (obj.Errors != undefined) {
                  $("#error").text(obj.Errors["0"].Message)
                } 
                
                var objConfidence = obj.images["0"].transaction.confidence;
                //console.log(objConfidence);

                objName = obj.images["0"].transaction.subject_id;
                //console.log(objName);

              //for (var i = 0; i < arr.length; i++) {
                    if (objConfidence > 0.600) {
                    var percentMatch = objConfidence * 100;
                    $("#percent-match").text(percentMatch + "% match to " + objName);
                    }
                    if (objConfidence < 0.600) {
                    $("#percent-match").text("This face is not in the current gallery");
                    }

//message if no face detected
//console.log(obj.Errors[0].Message);


//var objConfidence = obj.images[0].transaction.confidence;
//console.log(objConfidence);
});
};
});
</script>
</body>

</html>